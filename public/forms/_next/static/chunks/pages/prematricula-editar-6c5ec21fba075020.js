(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[62],{2434:function(e,n,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/prematricula-editar",function(){return a(7904)}])},3237:function(e,n,a){"use strict";var t=a(5893),o=a(7294),r=a(6134),i=a.n(r),s=function(e){var n=e.labelName,a=e.data;return(0,t.jsxs)("div",{className:i().inputContainer,children:[(0,t.jsx)("label",{children:n}),(0,t.jsx)("span",{children:a||"N/A"})]})};n.Z=(0,o.memo)(s)},7852:function(e,n,a){"use strict";var t=a(5893);n.Z=function(){return(0,t.jsxs)("div",{className:"loading-container",children:[(0,t.jsx)("span",{className:"ball"}),(0,t.jsx)("span",{className:"ball"}),(0,t.jsx)("span",{className:"ball"})]})}},7127:function(e,n,a){"use strict";var t=a(5893),o=a(7294),r=a(6134),i=a.n(r),s=a(6266),c=a(8043),l=a(8039),u=a(9935),d=a(3750),m=function(e){var n=e.salvarTelefone,a=e.fechar,o=(0,u.c)({initialValues:{numero:"",tipo:"",preferencial:!1},validations:{numero:{required:{value:!0,message:"Este campo \xe9 obrigat\xf3rio."}},tipo:{required:{value:!0,message:"Este campo \xe9 obrigat\xf3rio."}}}},(function(){return n(r)})),r=o.data,m=o.error,p=o.handleChange,f=o.handleSave;return(0,t.jsxs)("div",{className:i().blockSimbling,children:[(0,t.jsx)("button",{className:"".concat(i().saveBtn," ").concat(i().positionBtn),onClick:f,children:"Salvar"}),(0,t.jsx)("button",{className:"".concat(i().deleteBtn," ").concat(i().bigger),onClick:a,children:(0,t.jsx)(d.z3f,{})}),(0,t.jsx)(s.Z,{changeInputText:p,inputId:"numero",labelName:"Telefone: ",value:r.numero,mask:"(99) 99999-9999",error:m.numero}),(0,t.jsx)(c.Z,{changeSelectedOption:p,options:[{l:"Celular",v:1},{l:"Comercial",v:2},{l:"Residencial",v:3}],inputId:"tipo",labelName:"Tipo:",value:r.tipo,error:m.tipo}),(0,t.jsx)(l.Z,{Label:"Telefone preferencial",id:"preferencial",name:"preferencial",onChange:p,value:1,nameField:"Telefone preferencial",selectedValue:r.preferencial})]})};n.Z=(0,o.memo)(m)},7904:function(e,n,a){"use strict";a.r(n),a.d(n,{default:function(){return M}});var t=a(5893),o=a(9008),r=a(6134),i=a.n(r),s=a(3237),c=a(1163),l=a(3750),u=a(8193),d=a(5934),m=a(7294),p=a(7837),f=a(7852),h=a(6673),v=a(6266),_=a(9935);function b(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}var j=function(e){var n=e.isOpen,a=e.closeModal,o=e.child,r=e.resp,s=(0,m.useState)(""),c=s[0],u=s[1],d=(0,_.c)({validations:{no_aluno:{required:{value:!0,message:"Este campo \xe9 obrigat\xf3rio."},pattern:{value:"^[A-Za-z\xe1\xe0\xe2\xe3\xe9\xe8\xea\xed\xef\xf3\xf4\xf5\xf6\xfa\xe7\xf1\xc1\xc0\xc2\xc3\xc9\xc8\xcd\xcf\xd3\xd4\xd5\xd6\xda\xc7\xd1 ]+$",message:"Nome s\xf3 pode conter letras"}},dt_nascimento:{required:{value:!0,message:"Este campo \xe9 obrigat\xf3rio."},custom:{isValid:function(e){return parseInt(e.split("/")[0])<=31&&parseInt(e.split("/")[1])<=12},message:"Data inv\xe1lida."}}}},(function(){return Z(j)}),o),j=d.data,x=d.error,g=d.handleChange,N=d.handleSubmit,S=(0,m.useState)(!1),y=S[0],O=S[1],Z=function(e){O(!0),u(""),fetch("https://escolacanarinho.com.br/canarinhoapi/routes/preMatricula/index.php",{method:"POST",body:JSON.stringify({irmaos:[{nome_irmao:e.no_aluno,data_nascimento:e.dt_nascimento}],id:o.co_seq_pre_matricula,responsavel:r,update:3})}).then((function(e){return e.json()})).then((function(n){if("dados salvos com sucesso"===n){var t=function(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{},t=Object.keys(a);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(a).filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})))),t.forEach((function(n){b(e,n,a[n])}))}return e}({},e,{co_seq_pre_matricula:o.co_seq_pre_matricula});a(t)}})).catch((function(e){u("Houve um error no servidor, tente novamente mais tarde...")})).finally((function(){return O(!1)}))};return(0,t.jsx)(p.Z,{isOpen:n,children:(0,t.jsxs)("form",{className:"modal-container",onSubmit:N,children:[(0,t.jsx)("p",{className:"error-message",children:c}),(0,t.jsx)(h.Z,{changeInputText:g,inputId:"no_aluno",labelName:"Nome do irm\xe3o:",value:j.no_aluno,error:x.no_aluno}),(0,t.jsx)(v.Z,{changeInputText:g,inputId:"dt_nascimento",labelName:"Data de nascimento: ",value:j.dt_nascimento,mask:"99/99/9999",error:x.dt_nascimento}),(0,t.jsx)("button",{className:"".concat(i().deleteBtn," ").concat(i().bigger),onClick:function(){return a()},children:(0,t.jsx)(l.z3f,{})}),(0,t.jsx)("div",{className:"".concat(i().flexInput," ").concat(i().buttons),children:(0,t.jsx)("button",{type:"submit",children:y?(0,t.jsx)(f.Z,{}):"Salvar"})})]})})},x=(0,m.memo)(j),g=a(7127),N=a(8043),S=a(8039),y=function(e){var n=e.salvarIrmao,a=e.fechar,o=(0,_.c)({validations:{nome_irmao:{required:{value:!0,message:"Este campo \xe9 obrigat\xf3rio."},pattern:{value:"^[A-Za-z\xe1\xe0\xe2\xe3\xe9\xe8\xea\xed\xef\xf3\xf4\xf5\xf6\xfa\xe7\xf1\xc1\xc0\xc2\xc3\xc9\xc8\xcd\xcf\xd3\xd4\xd5\xd6\xda\xc7\xd1 ]+$",message:"Nome s\xf3 pode conter letras"}},data_nascimento:{required:{value:!0,message:"Este campo \xe9 obrigat\xf3rio."}},data_interesse:{required:{value:!0,message:"Este campo \xe9 obrigat\xf3rio."}},unidade:{required:{value:!0,message:"Este campo \xe9 obrigat\xf3rio."}}}},(function(){return n(r)}),{nome_irmao:"",data_nascimento:"",data_interesse:"",cuidados_especiais:"",turno:1,unidade:"",disponibilidade:0,ce_desc:""}),r=o.data,s=o.error,c=o.handleChange,u=o.handleSave;return(0,t.jsxs)("div",{className:i().blockSimbling,children:[(0,t.jsx)("button",{className:"".concat(i().saveBtn," ").concat(i().positionBtn),onClick:u,children:"Salvar"}),(0,t.jsx)("button",{className:"".concat(i().deleteBtn," ").concat(i().bigger),onClick:a,children:(0,t.jsx)(l.z3f,{})}),(0,t.jsx)(h.Z,{changeInputText:c,inputId:"nome_irmao",labelName:"Nome do irm\xe3o:",value:r.nome_irmao,error:s.nome_irmao}),(0,t.jsx)(v.Z,{changeInputText:c,inputId:"data_nascimento",labelName:"Data de nascimento: ",value:r.data_nascimento,mask:"99/99/9999",error:s.data_nascimento}),(0,t.jsx)(v.Z,{changeInputText:c,inputId:"data_interesse",labelName:"Data de interesse: ",value:r.data_interesse,mask:"99/9999",error:s.data_interesse}),(0,t.jsx)(N.Z,{changeSelectedOption:c,options:[{v:3,l:"212 Sul"},{v:2,l:"208 Norte"}],inputId:"unidade",labelName:"Unidade (*):",value:r.unidade,error:s.unidade}),(0,t.jsx)("p",{children:"Turno: "}),(0,t.jsxs)("div",{className:i().radios,children:[(0,t.jsx)(S.Z,{Label:"integral",id:"integral",name:"turno",onChange:c,value:3,nameField:"Integral (matutino e vespertino)",selectedValue:r.turno}),(0,t.jsx)(S.Z,{Label:"matutino",id:"matutino",name:"turno",onChange:c,value:1,nameField:"Matutino",selectedValue:r.turno}),(0,t.jsx)(S.Z,{Label:"vespertino",id:"vespertino",name:"turno",onChange:c,value:2,nameField:"Vespertino",selectedValue:r.turno})]}),(0,t.jsx)("p",{className:i().spacing,children:"Disponibilidade para mudan\xe7a de turno:"}),(0,t.jsxs)("div",{className:i().radios,children:[(0,t.jsx)(S.Z,{Label:"Sim",id:"sim",name:"disponibilidade",onChange:c,value:1,nameField:"Sim",selectedValue:r.disponibilidade}),(0,t.jsx)(S.Z,{Label:"Nao",id:"nao",name:"disponibilidade",onChange:c,value:0,nameField:"Nao",selectedValue:r.disponibilidade})]}),(0,t.jsxs)("div",{className:i().flexInput,children:[(0,t.jsx)(N.Z,{changeSelectedOption:c,options:[{l:"N\xe3o",v:0},{l:"Sim",v:1}],inputId:"cuidados_especiais",labelName:"Cuidados especiais? ",value:r.cuidados_especiais}),r.cuidados_especiais&&"1"===r.cuidados_especiais&&(0,t.jsx)(h.Z,{changeInputText:c,inputId:"ce_desc",placeholder:"Quais?",value:r.ce_irmao})]})]})},O=(0,m.memo)(y);function Z(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function I(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{},t=Object.keys(a);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(a).filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})))),t.forEach((function(n){Z(e,n,a[n])}))}return e}function k(e){return function(e){if(Array.isArray(e)){for(var n=0,a=new Array(e.length);n<e.length;n++)a[n]=e[n];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var C={1:"Pai",2:"M\xe3e",3:"Outro"},T={1:"Celular",2:"Comercial",3:"Residencial"},q={3:"Integral (matutino e vespertino)",1:"Matutino",2:"Vespertino"},E={2:"208 Norte",3:"212 Sul"},P=new Headers;P.append("Content-Type","application/json");var w=function(e){return e.split("-").reverse().join("/")},M=function(){var e=(0,c.useRouter)().push,n=(0,m.useState)(!1),a=n[0],r=n[1],p=(0,m.useState)(!1),f=p[0],h=p[1],v=(0,m.useState)({co_seq_responsavel:"",no_responsavel:"",ds_email_responsavel:"",co_parentesco:""}),_=v[0],b=v[1],j=(0,m.useState)(!1),N=j[0],S=j[1],y=(0,m.useState)([]),Z=y[0],M=y[1],B=(0,m.useState)([]),D=B[0],A=B[1],F=(0,m.useState)(!0),V=F[0],z=F[1],L=(0,m.useState)(!1),J=L[0],R=L[1],H=(0,m.useState)({co_seq_pre_matricula:"",no_aluno:"",dt_nascimento:""}),Q=H[0],X=H[1],$=(0,m.useState)(!1),G=$[0],U=$[1];(0,m.useEffect)((function(){K()}),[]);var K=function(){var n=localStorage.getItem("token");fetch("https://escolacanarinho.com.br/canarinhoapi/routes/preMatricula/search.php",{method:"POST",body:JSON.stringify({acesso:n})}).then((function(e){return e.json()})).then((function(e){b(e.responsavel),M(e.telefones),A(e.filhos)})).catch((function(n){U(!0),localStorage.removeItem("token"),setTimeout((function(){e("/")}),5e3)})).finally((function(){z(!1)}))};return(0,t.jsxs)("div",{className:i().container,children:[(0,t.jsxs)(o.default,{children:[(0,t.jsx)("title",{children:"Pre Matricula"}),(0,t.jsx)("meta",{name:"description",content:"Generated by create next app"}),(0,t.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,t.jsx)(x,{child:Q,closeModal:function(e){if(e){var n=D.find((function(n){return n.co_seq_pre_matricula===e.co_seq_pre_matricula}));if(n){var a=D.indexOf(n),t=D;t[a]=I({},t[a],e),A(t)}}S(!1)},resp:_.co_seq_responsavel,isOpen:N}),J&&(0,t.jsx)("div",{className:i().processing,children:(0,t.jsx)("img",{src:"loading.gif",alt:"Processing",height:80,width:80})}),(0,t.jsxs)("main",{className:i().main,children:[(0,t.jsx)("h1",{children:"Pr\xe9-matr\xedcula"}),(0,t.jsx)("hr",{}),V&&(0,t.jsx)("div",{className:"loading-container",children:(0,t.jsx)("img",{src:"loading.gif",alt:"Processing",height:80,width:80})}),!V&&G&&(0,t.jsx)("div",{children:(0,t.jsx)("p",{className:"error-message-input bigger",children:"Token inv\xe1lido, redirecionando para o login..."})}),!V&&!G&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"d-flex",children:[(0,t.jsx)(s.Z,{labelName:"Responsavel:",data:_.no_responsavel}),(0,t.jsx)(s.Z,{labelName:"E-mail:",data:_.ds_email_responsavel}),(0,t.jsx)(s.Z,{labelName:"Parentesco:",data:C[_.co_parentesco]})]}),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{className:"".concat(i().addButton," minor-margin"),onClick:function(e){e.preventDefault(),h(!0)},children:"Adicionar telefone +"}),(0,t.jsx)("br",{}),f&&(0,t.jsx)(g.Z,{salvarTelefone:function(e){localStorage.getItem("token");var n={telefones:[I({},e)],responsavel:_.co_seq_responsavel,update:1};fetch("https://escolacanarinho.com.br/canarinhoapi/routes/preMatricula/index.php",{method:"POST",headers:P,body:JSON.stringify(n)}).then((function(e){return e.json()})).then((function(e){M(k(Z).concat([e]))})).catch((function(e){console.log(e)})).finally((function(){z(!1)})),h(!1)},fechar:function(){return h(!1)}}),Z.length>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h4",{children:"Telefones"}),(0,t.jsx)("hr",{}),Z.map((function(e){return(0,t.jsxs)("div",{className:"d-flex border position-component",children:[(0,t.jsx)(s.Z,{labelName:"Telefone:",data:e.nu_telefone}),(0,t.jsx)(s.Z,{labelName:"Tipo:",data:T[e.co_tipotelefone]}),(0,t.jsx)("button",{className:"".concat(i().deleteBtn," ").concat(i().bigger),onClick:function(){return function(e){R(!0);var n={responsavel:_.co_seq_responsavel,delete:1,id:e};fetch("https://escolacanarinho.com.br/canarinhoapi/routes/preMatricula/delete.php",{method:"POST",body:JSON.stringify(n)}).then((function(e){return e.json()})).then((function(n){"sucesso!!"===n&&M((function(n){return n.filter((function(n){return n.co_seq_responsaveltelefone!==e}))}))})).catch((function(e){alert("Error ao deletar o a crian\xe7a, tente novamente mais tarde...")})).finally((function(){return R(!1)}))}(e.co_seq_responsaveltelefone)},children:(0,t.jsx)(l.z3f,{})})]},(0,d.Z)())}))]})]}),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{className:"".concat(i().addButton," minor-margin"),onClick:function(e){e.preventDefault(),r(!0)},children:"Adicionar crian\xe7a +"}),a&&(0,t.jsx)(O,{salvarIrmao:function(e){r(!1);localStorage.getItem("token");var n={irmaos:[{data_nascimento:e.data_nascimento,nome_irmao:e.nome_irmao,ce_desc:e.ce_desc,cuidados_especiais:e.cuidados_especiais}],data_interesse:e.data_interesse,turno:e.turno,unidade:e.unidade,responsavel:_.co_seq_responsavel,update:2};fetch("https://escolacanarinho.com.br/canarinhoapi/routes/preMatricula/index.php",{method:"POST",headers:P,body:JSON.stringify(n)}).then((function(e){return e.json()})).then((function(e){A(k(D).concat([e]))})).catch((function(e){})).finally((function(){z(!1)}))},fechar:function(){return r(!1)}}),D.length>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h4",{children:"Crian\xe7as"}),(0,t.jsx)("hr",{}),D.map((function(e){return(0,t.jsxs)("div",{className:"grids border position-component",children:[(0,t.jsx)(s.Z,{labelName:"Nome:",data:e.no_aluno}),(0,t.jsx)(s.Z,{labelName:"Estado da vaga:",data:e.no_estado}),(0,t.jsx)(s.Z,{labelName:"Data de nascimento:",data:w(e.dt_nascimento)}),(0,t.jsx)(s.Z,{labelName:"Data de interesse:",data:w(e.dt_interesse)}),(0,t.jsx)(s.Z,{labelName:"Turno pretendio:",data:q[e.co_turno]}),(0,t.jsx)(s.Z,{labelName:"Escola pretendia:",data:E[e.co_escola]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("button",{className:"".concat(i().deleteBtn," ").concat(i().bigger),onClick:function(){return function(e){R(!0);var n={responsavel:_.co_seq_responsavel,delete:2,id:e};fetch("https://escolacanarinho.com.br/canarinhoapi/routes/preMatricula/delete.php",{method:"POST",headers:P,body:JSON.stringify(n)}).then((function(e){return e.json()})).then((function(n){"sucesso!!"===n&&A((function(n){return n.filter((function(n){return n.co_seq_pre_matricula!==e}))}))})).catch((function(e){alert("Error ao deletar o a crian\xe7a, tente novamente mais tarde...")})).finally((function(){return R(!1)}))}(e.co_seq_pre_matricula)},children:(0,t.jsx)(l.z3f,{})}),(0,t.jsx)("button",{className:"".concat(i().editBtn," ").concat(i().bigger),onClick:function(){return n=e.co_seq_pre_matricula,a=e.no_aluno,t=e.dt_nascimento,X({co_seq_pre_matricula:n,dt_nascimento:t,no_aluno:a}),void S(!0);var n,a,t},children:(0,t.jsx)(u.QML,{size:17})})]})]},(0,d.Z)())}))]})]}),(0,t.jsx)("div",{className:"".concat(i().buttons," ").concat(i().flexInput),children:(0,t.jsx)("div",{className:"".concat(i().flexInput," ").concat(i().buttons),children:(0,t.jsx)("button",{onClick:function(){localStorage.removeItem("token"),e("/")},children:"Sair"})})})]})]})]})}}},function(e){e.O(0,[13,617,567,434,774,888,179],(function(){return n=2434,e(e.s=n);var n}));var n=e.O();_N_E=n}]);